{% extends 'base.html' %}
{% load static %}

{% block title %}
Posts
{% endblock title %}


{% block content %}

    <div class="row">
        <div class="col-md-8">

            {% for post in posts_qs %}
                <h4>{{post.author}}</h4><br>
                <img src="{% static '{{post.image.url}}' %}">
                <p>{{post.content}}</p><br>

                <form method="post" action="{% url 'like-unlike-post' %}">
                    {% csrf_token %}
                    <input type="hidden" name="post_id" value="{{post.id}}">

                    {% if profile not in post.liked_by.all %}
                    <button type="submit" class="btn btn-primary">Like</button>
                    {% else %}
                    <button type="submit" class="btn btn-primary">Unlike</button>
                    {% endif %}
                </form>

                <p>Total likes : {{post.likes}}</p>

                {% if post.comment_set.exists %}
                <h4>Comments</h4>

                    {% for comment in post.comment_set.all %}
                        <p><strong>{{comment.user}}</strong> ---> {{comment.body}}</p><br>
                    {% endfor %}

                {% endif %}

                <form action="" method="post">
                    {% csrf_token %}
                    {{new_comment_form.as_p}}
                    <input type="hidden" name="post_id" value="{{post.id}}">
                    <button type="submit" class="btn btn-success" name="submit_comment_form">Comment</button>
                </form>
                <hr>
            {% endfor %}

        </div>

        <div class="col-md-4" style="border-left: groove">

            <h1>Create a post</h1>
            <hr>
            <form action="" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{new_post_form.as_p}}
                <button type="submit" class="btn btn-secondary" name="submit_post_form">Post</button>
            </form>

        </div>

    </div>


{% endblock content %}


{% block scripts %}
{% endblock scripts %}
